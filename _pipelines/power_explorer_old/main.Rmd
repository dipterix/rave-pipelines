---
title: "RAVE Pipeline Markdown Template"
output:
  html_document: default
  pdf_document: default
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
# This code block sets up the engine environment
# Please do not remove me
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
build_pipeline <- raveio::configure_knitr()
# build_pipeline(make_file = "make-power_explorer.R")
```

```{rave check_load_power, language = "R", export = "repository", cue = "always"}
# raveio::pipeline_debug(quick = FALSE)
library(raveio)
subject_id <- sprintf("%s/%s", project_name, subject_code)
repository <- prepare_subject_power(
  subject = subject_id, electrodes = loaded_electrodes, 
  epoch_name = epoch_name, reference_name = reference_name,
  time_windows = c(trial_starts, trial_ends))
repository
```

## Build, Visualize, & Run

Please make sure the following code block is at the end of your pipeline file. This block will build the pipeline and generate a `make-power_explorer.R` script with your pipeline markdown file. `RAVE` will use the generated pipeline script to execute the pipeline in the dashboard application, or in massive production mode.

```{r build, echo=FALSE, results='hide'}
build_pipeline(make_file = "make-power_explorer.R")
```


Once the pipeline script `make-power_explorer.R` is built, you can visualize and execute the pipeline without the need of re-knit this document. Notice we use `r` block instead of `rave`. (This is because the code blocks are not part of pipeline targets.)

```{r execute}
Sys.setenv("RAVE_PIPELINE" = normalizePath("."))
raveio::pipeline_run(type = "vanilla")
raveio::pipeline_progress(method = 'details')
```

```{r visualize, echo=FALSE}
Sys.setenv("RAVE_PIPELINE" = normalizePath("."))
raveio::pipeline_visualize()
```








